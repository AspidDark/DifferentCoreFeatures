<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Invoice #{{Number}}</title>
    <style>
          /* Reset and base styles */ * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
          }

          body {
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
              line-height: 1.6;
              color: #333;
              background-color: #f8f9fa;
              padding: 0;
              margin: 0;
          }

          .invoice-container {
              max-width: 800px;
              margin: 0 auto;
              background: white;
              padding: 20px;
              border-radius: 8px;
              box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          }
          /* Header */

          .invoice-header {
              margin-bottom: 30px;
              border-bottom: 2px solid #e9ecef;
              padding-bottom: 20px;
          }

          .invoice-title {
              font-size: 28px;
              font-weight: bold;
              color: #2c3e50;
              margin-bottom: 10px;
          }

          .invoice-dates {
              display: flex;
              justify-content: space-between;
              font-size: 14px;
              color: #6c757d;
          }

              .invoice-dates p {
                  margin: 0;
              }
          /* Addresses -
        Side by Side Layout */

          .addresses {
              display: flex;
              justify-content: space-between;
              gap: 30px;
              margin-bottom: 30px;
          }

          .address-box {
              flex: 1;
              background: #f8f9fa;
              padding: 20px;
              border-radius: 6px;
              border: 1px solid #e9ecef;
          }

          .address-title {
              font-weight: 600;
              color: #2c3e50;
              margin-bottom: 10px;
              font-size: 16px;
          }

          .address-content {
              font-size: 14px;
              line-height: 1.5;
          }

              .address-content p {
                  margin: 2px 0;
              }

          .company-name {
              font-weight: 600;
              color: #2c3e50;
          }

          .email {
              color: #007bff;
              text-decoration: none;
          }
          /* Items Table */

          .items-section {
              margin-bottom: 30px;
          }

          .items-title {
              font-size: 20px;
              font-weight: 600;
              color: #2c3e50;
              margin-bottom: 15px;
          }

          .items-table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 20px;
          }

              .items-table th {
                  background: #f8f9fa;
                  padding: 12px 8px;
                  text-align: left;
                  font-weight: 600;
                  color: #2c3e50;
                  border-bottom: 2px solid #dee2e6;
                  font-size: 14px;
              }

              .items-table td {
                  padding: 12px 8px;
                  border-bottom: 1px solid #dee2e6;
                  font-size: 14px;
              }

                  .items-table th:last-child, .items-table td:last-child {
                      text-align: right;
                  }

                  .items-table th:nth-child(3), .items-table
                  td:nth-child(3), .items-table th:nth-child(4), .items-table
                  td:nth-child(4) {
                      text-align: right;
                  }

              .items-table tbody tr:hover {
                  background-color: #f8f9fa;
              }
          /* Totals */

          .totals {
              display: flex;
              justify-content: flex-end;
          }

          .totals-container {
              width: 250px;
          }

          .totals-row {
              display: flex;
              justify-content: space-between;
              padding: 8px 0;
              font-size: 14px;
          }

              .totals-row.total {
                  border-top: 2px solid #dee2e6;
                  padding-top: 15px;
                  margin-top: 10px;
                  font-size: 18px;
                  font-weight: bold;
                  color: #2c3e50;
              }

              .totals-row.subtotal {
                  border-top: 1px solid #dee2e6;
                  padding-top: 10px;
                  margin-top: 5px;
              }
          /* Print styles */

          @media print {
              body {
                  background: white;
                  padding: 0;
                  margin: 0;
              }

              .invoice-container {
                  box-shadow: none;
                  padding: 20px;
                  max-width: none;
              }

              .invoice-header {
                  margin-bottom: 20px;
                  padding-bottom: 15px;
              }

              .invoice-title {
                  font-size: 24px;
              }

              .addresses {
                  gap: 20px;
                  margin-bottom: 20px;
              }

              .address-box {
                  padding: 15px;
              }

              .items-table th, .items-table td {
                  padding: 8px 6px;
                  font-size: 12px;
              }

              .items-title {
                  font-size: 18px;
                  margin-bottom: 10px;
              }

              .totals-container {
                  width: 200px;
              }

              .totals-row {
                  font-size: 12px;
                  padding: 6px 0;
              }

                  .totals-row.total {
                      font-size: 16px;
                      padding-top: 12px;
                  }
              /* Ensure page breaks don't occur inside important sections */
              .invoice-header, .addresses, .items-section, .totals {
                  page-break-inside: avoid;
              }
              /* Remove hover effects in print */

              .items-table tbody tr:hover {
                  background-color: transparent;
              }
              /* Ensure borders are visible in print */
              .address-box {
                  border: 1px solid #ccc;
              }

              .items-table th, .items-table td {
                  border-bottom: 1px solid #ccc;
              }

              .items-table th {
                  border-bottom: 2px solid #ccc;
              }
          }
          /* Responsive design */

          @media (max-width: 768px) {
              .invoice-container {
                  padding: 20px;
              }

              .addresses {
                  flex-direction: column;
                  gap: 20px;
              }

              .invoice-dates {
                  flex-direction: column;
                  gap: 5px;
              }

              .items-table {
                  font-size: 12px;
              }

                  .items-table th, .items-table td {
                      padding: 8px 4px;
                  }
          }
    </style>
</head>
<body>
    <div class="invoice-container">
        <!-- Header with Logo -->
        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
            <div>
                <h1 class="invoice-title">Invoice #{{Number}}</h1>
                <div class="invoice-dates">
                    <p><strong>Issued:</strong> {{formatDate IssuedDate}}</p>
                    <p><strong>Due:</strong> {{formatDate DueDate}}</p>
                </div>
            </div>
            <div>
                {{#if LogoBase64}}
                <img src="data:image/png;base64,{{LogoBase64}}"
                     alt="Logo"
                     style="height:50px; max-width:200px; object-fit:contain;" />
                {{/if}}
            </div>
        </div>
        <hr style="margin: 20px 0; border: none; border-top: 1px solid #e9ecef;" />

        <!-- Addresses - Side by Side -->
        <div class="addresses">
            <!-- Seller Address -->
            <div class="address-box">
                <h3 class="address-title">From:</h3>
                <div class="address-content">
                    <p class="company-name">{{SellerAddress.CompanyName}}</p>
                    <p>{{SellerAddress.Street}}</p>
                    <p>{{SellerAddress.City}}, {{SellerAddress.State}}</p>
                    <p class="email">{{SellerAddress.Email}}</p>
                </div>
            </div>

            <!-- Customer Address -->
            <div class="address-box">
                <h3 class="address-title">Bill To:</h3>
                <div class="address-content">
                    <p class="company-name">{{CustomerAddress.CompanyName}}</p>
                    <p>{{CustomerAddress.Street}}</p>
                    <p>{{CustomerAddress.City}}, {{CustomerAddress.State}}</p>
                    <p class="email">{{CustomerAddress.Email}}</p>
                </div>
            </div>
        </div>

        <!-- Items Table -->
        <div class="items-section">
            <h2 class="items-title">Items</h2>
            <table class="items-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Description</th>
                        <th>Price</th>
                        <th>Qty</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each LineItems}}
                    <tr>
                        <td>{{@index}}</td>
                        <td>{{Name}}</td>
                        <td>{{formatCurrency Price}}</td>
                        <td>{{formatNumber Quantity}}</td>
                        <td>{{formatCurrency (multiply Price Quantity)}}</td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>

        <!-- Totals -->
        <div class="totals">
            <div class="totals-container">
                <div class="totals-row subtotal">
                    <span>Subtotal:</span>
                    <span>{{formatCurrency Subtotal}}</span>
                </div>
                <div class="totals-row">
                    <span>Tax:</span>
                    <span>{{formatCurrency 0}}</span>
                </div>
                <div class="totals-row total">
                    <span>Total:</span>
                    <span>{{formatCurrency Total}}</span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>